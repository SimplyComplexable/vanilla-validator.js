function Validator(e,t){this.form=e,t&&(this.opts=mergeObjects(this.opts,t)),this.opts.errorValues=mergeObjects(this.opts.errorValues,this.getErrorValues(this.form));var r=this;if(this.reqInputs=this.form.querySelectorAll("[data-"+this.opts.attributes.validate+"]"),this.opts.attachToEvents.change)for(var s=0;s<this.reqInputs.length;s++)this.reqInputs.item(s).addEventListener("change",function(e){r.validateInput(this)},!1);this.opts.attachToEvents.submit&&this.form.addEventListener("submit",function(e){if(e.preventDefault(),r.validateNodeList(r.reqInputs))return r.opts.then(this)})}function getDataAttribute(e,t){if(e.dataset){var r=t.split("-").map(function(e,t){return t?e.charAt(0).toUpperCase()+e.substr(1):e}).join("");return e.dataset[r]}return e.getAttribute("data-"+t)}function mergeObjects(e,t){var r={},s=[].slice.call(arguments);for(var a in s)for(var n in s[a])if("object"==typeof s[a][n]&&s[a][n]){var l=Number(a)?r[n]:{};for(var i in s[a][n])s[a][n][i]&&(l[i]=s[a][n][i]);r[n]=l}else s[a][n]&&(r[n]=s[a][n]);return r}var generalTests={required:function(e){return!!e.value},length:function(e,t){var r=e.value;return t[1]?r.length>=t[0]&&r.length<=t[1]:r.length>=t[0]},regex:function(e,t){return new RegExp(t[0]).test(e.value)},vals:function(e,t){for(var r=e.value.toLowerCase(),s=[],a=0;a<t.length;a++)if(-1!==t[a].indexOf("!")){if(-1!==r.indexOf(t[0].substr(1)))return!1}else s.push(t[a].toLowerCase());return!s.length||new RegExp("^("+t.join("|")+")$").test(r)},number:function(e,t){var r=Number(e.value);return!isNaN(r)&&(!t[0]||(t[1]?r>=t[0]&&r<=t[1]:r>=t[0]))},phone:function(e,t){var r=Number(e.value.replace(/\D+/g,"")).toString().length;return void 0===t[0]?11===r||10===r:Number(t[0])?11===r:10===r},email:function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)},date:function(e,t){var r=e.value,s=this.opts.dateValidator;return s?-1!==s.toString().indexOf("DateValidator")?s.testDate(r,t[0]):s.isMoment?s(r,t[0],!0).isValid():void 0:"Invalid Date"!==new Date(r)&&!isNaN(new Date(r))},url:function(e,t){var r=void 0===t[0]?"":t[0]?"https://(www.)?":"https?://(www.)?";return new RegExp(r+"[-a-zA-Z0-9@:%._+~#=]{2,256}.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)").test(e.value)},match:function(e,t){return e.value===this.form.querySelector("#"+t[0]).value}};Validator.prototype={opts:{dateValidator:null,then:function(e){e.submit()},attributes:{validate:"validate",errorMessage:"error-message",errorClass:"error-class",errorInputClass:"error-input-class"},delimiters:{func:",",parameters:":"},errorValues:{eClass:"error-message",eInputClass:"error-input",eMessage:"Please enter a valid value"},attachToEvents:{change:!0,submit:!0}},generalTests:generalTests,tests:{text:{required:generalTests.required,regex:generalTests.regex,length:generalTests.length,number:generalTests.number,phone:generalTests.phone,email:generalTests.email,vals:generalTests.vals,url:generalTests.url,date:generalTests.date,match:generalTests.match},"select-one":{required:generalTests.required,vals:generalTests.vals},checkbox:{required:function(){return this.checked},checked:function(){return this.checked}},color:{vals:generalTests.vals,range:function(e,t){for(var r=0;r<t.length;r++)t[r]=parseInt(t[r],16);var s=parseInt(e.value.substr(1),16);return!t[0]||(t[1]?s>=t[0]&&s<=t[1]:s>=t[0])}},date:{required:generalTests.required},file:{required:generalTests.required,accept:function(e){for(var t=getDataAttribute("accept").split(",").map(function(e){return e.trim()}),r=!1,s=0;s<t.length;s++)if(new RegExp(t[s]+"$").test(e.value)){r=!0;break}return r}},hidden:{required:generalTests.required,regex:generalTests.regex,length:generalTests.length,number:generalTests.number,phone:generalTests.phone,email:generalTests.email,vals:generalTests.vals,url:generalTests.url,match:generalTests.match},number:{required:generalTests.required,range:generalTests.number,match:generalTests.match},password:{required:generalTests.required,regex:generalTests.regex,length:generalTests.length,number:generalTests.number,match:generalTests.match},radio:{required:function(e){return!!document.querySelector('input[name="'+e.name+'"]:checked')}},search:{required:generalTests.required,regex:generalTests.regex,length:generalTests.length,number:generalTests.number,phone:generalTests.phone,email:generalTests.email,vals:generalTests.vals,url:generalTests.url,match:generalTests.match}},getErrorValues:function(e){var t=this.opts.attributes;return{eClass:getDataAttribute(e,t.errorClass),eInputClass:getDataAttribute(e,t.errorInputClass),eMessage:getDataAttribute(e,t.errorMessage)}},validateInput:function(e,t){function r(e,t){t&&(e.classList?e.classList.add(t):e.className+=" "+t)}var s=(t=t?mergeObjects(this.opts,t):this.opts).attributes,a=getDataAttribute(e,this.opts.attributes.validate).split(t.delimiters.func),n=!0;for(var l in a)try{var i=a[l].split(t.delimiters.parameters);if(!e.value&&"required"!==i[0])continue;if(!this.tests[e.type][i[0]].call(this,e,i.splice(1))){n=!1;break}}catch(t){console.error("Invalid rule: "+i[0]+" on type "+e.type)}var u=e.parentElement,o=u.querySelector("span."+t.errorValues.eClass),g=getDataAttribute(e,s.errorInputClass)||t.errorValues.eInputClass;if(n){if(o&&u.removeChild(o),g)if(e.classList)e.classList.remove(g);else{var c=e.className.indexOf(g);c&&(e.className=e.className.substr(c,g.length))}return!0}g&&r(e,g),o||(o=document.createElement("span"));var h=s.errorMessage,d=h+"-"+i[0].toLowerCase();this.form&&!t.errorValues[d]&&(t.errorValues[d]=getDataAttribute(this.form,d)),o.innerText=getDataAttribute(e,d)||t.errorValues[d]||getDataAttribute(e,h)||t.errorValues.eMessage;var v=getDataAttribute(e,s.errorClass)||t.errorValues.eClass;return v&&r(o,v),u.appendChild(o),!1},validateNodeList:function(e,t){for(var r=!0,s=0;s<e.length;s++)this.validateInput(e.item(s),t)||(r=!1);return r&&t&&t.then&&t.then(),r}};